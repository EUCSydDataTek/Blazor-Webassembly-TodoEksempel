@page "/Item/Create"
@inject ITodoService _TodoService
@inject NavigationManager _Navigation
@inject IToastService toastService

<ItemFormComponent ValidSubmit="CreateTodo"></ItemFormComponent>

@code {

    [CascadingParameter] BlazoredModalInstance BlazoredModal { get; set; } = default!;

    protected override void OnInitialized()
    {
        BlazoredModal.SetTitle("Create item");
        base.OnInitialized();
    }

    public async void CreateTodo(TodoItem item)
    {
        try
        {
            var newitem = await _TodoService.CreateTodoItemAsync(item);
            toastService.ShowSuccess("Item Created");
            await BlazoredModal.CloseAsync();
        }
        catch (Exception e)
        {
            toastService.ShowWarning(e.Message);
        }
        //_Navigation.NavigateTo($"/item/{newitem.Id}");
    }

}
