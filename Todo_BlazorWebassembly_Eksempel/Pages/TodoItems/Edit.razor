@page "/item/edit/{ItemId:int}"
@using Microsoft.AspNetCore.JsonPatch
@inject ITodoService _TodoService
@inject NavigationManager _Navigation
@inject IToastService toastService

<EditTodoComponent ValidSubmit="EditTodo" ItemId="ItemId"></EditTodoComponent>

@code {

    [CascadingParameter] BlazoredModalInstance BlazoredModal { get; set; } = default!;

    [Parameter] public int ItemId { get; set; }

    public async void EditTodo(JsonPatchDocument<TodoItemObject> item)
    {
        
        try
        {
            var newitem = await _TodoService.PartiallyEditTodoItemAsync(ItemId,item);
            toastService.ShowSuccess(newitem.Title, "Item updated");
            await BlazoredModal.CloseAsync();
        }
        catch (Exception e)
        {
            toastService.ShowWarning(e.Message);
        }
        


    }
}
